<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vehicle Parts Catalog</title>
<style>
body {
    font-family: Good Sans, ui-sans-serif, system-ui, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;
    background-color: #F7F6F2;
    margin: 0;
    padding: 20px;
}

.page {
  border: 1px solid #000;
  padding: 20px;
  margin: 30px 0;
  border-radius: 10px;
  background: #fafafa;
}

img {
  max-width: 300px;
  display: block;
  margin: 10px 0;
  border-radius: 8px;
}
</style>
</head>
<body>

<h1 style="text-align:center;">Vehicle Parts Catalog</h1>
<h4 style="text-align:center;">
  <a href="https://raw.githubusercontent.com/haodong191/haodong191.github.io/main/product-detail-page/assets/vehicle-parts-catalog-data.csv" 
     download="vehicle-parts-catalog-data.csv" 
     style="color: blue; text-decoration: underline;">
    Export to CSV
  </a>
</h4>


<div id="container"></div>

<script>
// Robust CSV parser that handles quoted commas
function parseCSV(str) {
    const rows = [];
    let row = [];
    let cell = "";
    let inQuotes = false;

    for (let i = 0; i < str.length; i++) {
        const char = str[i];
        if (char === '"' && inQuotes && str[i + 1] === '"') {
            // Handle double quotes inside quoted cell
            cell += '"';
            i++;
        } else if (char === '"') {
            inQuotes = !inQuotes;
        } else if (char === ',' && !inQuotes) {
            row.push(cell);
            cell = "";
        } else if ((char === '\n' || char === '\r') && !inQuotes) {
            if (cell || row.length > 0) {
                row.push(cell);
                rows.push(row);
                row = [];
                cell = "";
            }
        } else {
            cell += char;
        }
    }
    if (cell || row.length > 0) {
        row.push(cell);
        rows.push(row);
    }
    return rows;
}

async function loadCSV() {
    const response = await fetch("assets/vehicle-parts-catalog-data.csv");
    const text = await response.text();

    const rows = parseCSV(text.trim());
    const headers = rows.shift();

    const container = document.getElementById("container");

rows.forEach((row, i) => {
    const page = document.createElement("div");
    page.className = "page";

    let html = `<h2>Product ${i + 1}</h2>`;

    // Render Product Name first
    const nameIndex = headers.findIndex(h => h.toLowerCase() === "product name");
    if (nameIndex !== -1) {
        const productName = row[nameIndex].trim();
        html += `<p><strong>Product Name:</strong> ${productName}</p>`;

        // Render Image right after Product Name
        const imageIndex = headers.findIndex(h => h.toLowerCase() === "image");
        if (imageIndex !== -1 && row[imageIndex]) {
            html += `<img src="${row[imageIndex].trim()}" alt="Image">`;
        }
    }

    // Render all other fields except Product Name and Image
    headers.forEach((h, j) => {
        const value = row[j] ? row[j].trim() : "";
        if (h.toLowerCase() === "product name" || h.toLowerCase() === "image") return;
        
        if (h.toLowerCase() === "description") {
            html += `<p><strong>${h}:</strong></p>${value}`;
        } else {
            html += `<p><strong>${h}:</strong> ${value}</p>`;
        }
    });

    page.innerHTML = html;
    container.appendChild(page);
});

}

loadCSV();
</script>

</body>
</html>
